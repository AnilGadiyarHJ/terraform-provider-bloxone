---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "Terraform Migration Guide"
subcategory: ""
description: |-
  
---

# Terraform Migration Guide

## Introduction
This document provides critical steps to migration your Terraform deployment for BloxOne DDI.

## Simplified Steps

- `Backup` your existing Terraform state file
- `List all resources` in your existing Terraform state file
- `Clean up old provider state file` by removing all resources from the state file
- `Update all resources` in your existing Terraform code
- `Run Terraform plan` to verify the changes

## Detailed Steps
## Backup

* Backup your file in Terraform before upgrading. To backup your Terraform data you can simply duplicate or create a copy of the state file in your desired backup location. This file contains the current state of your infrastructure.

* For example, you can use the following commands in your terminal:

* Make a backup by copying the state file to a backup directory

```terraform
cp terraform.tfstate /path/to/backup/directory/terraform_backup.tfstate
```

* Alternatively, you can use 'mv' to move the state file to a backup directory
```terraform
mv terraform.tfstate /path/to/backup/directory/terraform_backup.tfstate
```
* This action helps ensure that you have a snapshot of your infrastructure's state at that specific moment, allowing you to revert or refer to it if needed. Adjust the paths and filenames according to your directory structure and preferences.

## List all resources

* The next step in the process is to List all resources managed by Terraform along with their IDs, you can use the terraform state list command. This will display the names of all resources present in the current state file. To retrieve their IDs, you can use terraform state show followed by the resource name. For instance:
```terraform
terraform state list | while read -r resource; do echo "Resource: $resource"; terraform state show "$resource" | grep -w "id"; echo "----------------------"; done
```
## Clean up old provider state file

* Clean-up the old provider state file by removing all resources listed in the Terraform state using the following command:
```terraform
terraform state list | while read -r resource; do
terraform state rm "$resource"
```
## Update all resources

* Update all resources from " b1ddi_ip_space" to " bloxone_ipam_ip_space " within your Terraform.
For example,
```terraform
resource "b1ddi_ip_space" "example_tf_space" {

name = "example_tf_space"

Comment = "Example IP space created by the terraform provider"

}
```
* Updated to bloxone new provider resource:
```terraform
resource "bloxone_ipam_ip_space" "example_tf_space" { name = "example_tf_space" comment = "Example IP space created by the terraform provider" }
```

* Using the gathered resource ID from the previous step, create an import statement like this:
```terraform
import { 
id = "ipam/ip_space/5f26be86-abef-11ee-babd-a2f371a672c6" 
to = bloxone_ipam_ip_space.example_tf_space 
}
```
* This command imports the resource with the specified ID into the Terraform state, associating it with the bloxone_ipam_ip_space.example_tf_space. Adjust the IDs and resource names as needed for your configuration.

## Run Terraform plan

* The following configuration edits are required for Migration from b1ddi to bloxone in provider.tf
```terraform
terraform { 
required_providers { 
    b1ddi = { 
        version = "0.1.0" 
        source = "infobloxopen/b1ddi" 
        # source = "registry.terraform.io/infobloxopen/b1dd1"
      } 
    bloxone = { 
        version = "0.0.1" 
        source = "registry.terraform.io/infobloxopen/bloxone"
         } 
      } 
    }
```
## List of Resources

* The following table shows the old and new resource names.

| Old Resource Name     | New Resource Name                                                                                                                                                                                                                                                                                  |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| b1ddi_ip_space        | bloxone_ipam_ip_space                                                                                                                                                                                                                                                                              |
| b1ddi_address_block   | bloxone_ipam_address_block                                                                                                                                                                                                                                                                         |
| b1ddi_subnet          | bloxone_ipam_subnet                                                                                                                                                                                                                                                                                |
| b1ddi_range           | bloxone_ipam_range                                                                                                                                                                                                                                                                                 |
| b1ddi_fixed_address   | bloxone_dhcp_fixed_address                                                                                                                                                                                                                                                                         |
| b1ddi_address         | bloxone_ipam_address                                                                                                                                                                                                                                                                               |
| b1ddi_dns_view        | bloxone_dns_view                                                                                                                                                                                                                                                                                   |
| b1ddi_dns_forward_nsg | bloxone_dns_forward_nsg                                                                                                                                                                                                                                                                            |
| b1ddi_dns_auth_zone   | bloxone_dns_auth_zone                                                                                                                                                                                                                                                                              |
| b1ddi_dns_auth_nsg    | bloxone_dns_auth_nsg                                                                                                                                                                                                                                                                               |
| b1ddi_dns_record      | bloxone_dns_a_record, bloxone_dns_aaaa_record, bloxone_dns_caa_record, bloxone_dns_cname_record, bloxone_dns_dname_record, bloxone_dns_mx_record, bloxone_dns_naptr_record, bloxone_dns_ns_record, bloxone_dns_ptr_record, bloxone_dns_srv_record, bloxone_dns_svcb_record, bloxone_dns_txt_record |


## Common observations during migration

* `Error: Unsupported block type`
  * In resource "bloxone_dns_auth_zone" "tf_example_auth_zone":
    Blocks of type "internal_secondaries" are not expected here. Did you mean to define argument "internal_secondaries"? If so, use the equals sign to assign it a value.

  * Solution:
    Change block type from
    ```terraform
    internal_secondaries { host = data.b1ddi_dns_hosts.dns_host_by_name.results.0.id }
    ```
    to
    ```terraform
    internal_secondaries = [ { host = data.b1ddi_dns_hosts.dns_host_by_name.results.0.id }]
    ```
    
* `Error: Invalid Configuration for Read-Only Attribute`
  * In resource "bloxone_dns_a_record" "a_record": Cannot set value for this attribute as the provider has marked it as read-only. Remove the configuration line setting the value

  * Solution: remove type = "A" as it is read-only


* `During migration, next available resource, terraform attempts to forces replacement`
  * Solution : you can use below way to ignore changes, add this under your resource code.
     ```terraform
      lifecycle { ignore_changes = [next_available_id] #prevent_destroy = true}
    ```
* `Changes in default values for certain attribute`
  * During the migration process, there are changes in default values for certain attributes in the new provider. For instance, hostname_rewrite_regex has been modified from _[^a-zA-Z0-9.-]_ to _[^a-zA-Z0-9_.]._
  * Solution: You can customize and override these by specifying the desired values in your resource configuration.